<div id="canvas-container">
  <canvas id="gpu-canvas"></canvas>
  <div id="ui">
    <div class="ui-header">
      <span>‚ò∞ Menu</span>
      <button id="toggle-ui" aria-label="Toggle Menu">‚Äì</button>
    </div>
    <div id="ui-content">
      <!-- Resolution slider -->
      <div class="row">
        <label
          title="Internal render resolution (GPU grid size). Higher values cost more GPU time."
        >
          Resolution:
          <input
            id="gridSize"
            type="range"
            min="64"
            max="8192"
            step="64"
            value="1024"
            title="Internal GPU grid resolution: 64‚Äì8192"
          />
          <input
            id="gridSizeOut"
            class="numeric-input"
            type="number"
            min="64"
            max="8192"
            step="64"
            value="1024"
            title="Exact numeric grid resolution"
          />
        </label>
      </div>

      <div class="row button-row">
        <button id="resetCameraBtn" type="button" title="Reset pan and zoom">
          Reset Camera
        </button>
        <button
          id="exportFullBtn"
          type="button"
          title="Save a full-resolution PNG render"
        >
          Save Full-Res PNG
        </button>
      </div>

      <!-- zMin and dz (hidden) -->
      <div class="row" style="display: none">
        <label>
          zMin:
          <input id="zMin" type="number" step="0.1" value="0.0" />
          <input
            id="zMinOut"
            class="numeric-input"
            type="number"
            step="0.1"
            value="0.0"
          />
        </label>
      </div>

      <div class="row" style="display: none">
        <label>
          dz:
          <input id="dz" type="number" step="0.01" value="0.2" />
          <input
            id="dzOut"
            class="numeric-input"
            type="number"
            step="0.01"
            value="0.2"
          />
        </label>
      </div>

      <!-- Fractal type -->
      <div class="row">
        <label title="Select the fractal equation family">
          Fractal:
          <select id="fractalType" title="Choose the fractal formula (0-100)">
            <option value="0">Mandelbrot</option>
            <option value="1">Tricorn</option>
            <option value="2">Burning Ship</option>
            <option value="3">Perpendicular Mandelbrot</option>
            <option value="4">Celtic</option>
            <option value="5">Buffalo</option>
            <option value="6">Phoenix</option>
            <option value="7">Cubic Multibrot (z¬≥ + c)</option>
            <option value="8">Quartic Multibrot (z‚Å¥ + c)</option>
            <option value="9">Cosine</option>
            <option value="10">Sine</option>
            <option value="11">Heart</option>
            <option value="12">Perpendicular Buffalo</option>
            <option value="13">Spiral Mandelbrot</option>
            <option value="14">Quintic Multibrot (z‚Åµ + c)</option>
            <option value="15">Sextic Multibrot (z‚Å∂ + c)</option>
            <option value="16">Tangent fractal (tan z + c)</option>
            <option value="17">Exponential fractal (exp z + c)</option>
            <option value="18">Septic Multibrot (z‚Å∑ + c)</option>
            <option value="19">Octic Multibrot (z‚Å∏ + c)</option>
            <option value="20">Inverse Mandelbrot (1/z¬≤ + c)</option>
            <option value="21">Burning Ship Deep Zoom</option>
            <option value="22">Cubic Burning Ship (|z|¬≥ + c)</option>
            <option value="23">Quartic Burning Ship (|z|‚Å¥ + c)</option>
            <option value="24">Quintic Burning Ship (|z|‚Åµ + c)</option>
            <option value="25">Hexic Burning Ship (|z|‚Å∂ + c)</option>
            <option value="26">Nova (Newton z¬≥‚àí1)</option>
            <option value="27">Man-o-War</option>
            <option value="28">Stretched Celtic Spiral</option>
            <option value="29">Polar-Flame fractal</option>
            <option value="30">Inverse Cubic (1/z¬≥ + c)</option>
            <option value="31">Inverse Quartic (1/z‚Å¥ + c)</option>
            <option value="32">Inverse Quintic (1/z‚Åµ + c)</option>
            <option value="33">Inverse Sextic (1/z‚Å∂ + c)</option>
            <option value="34">Inverse Septic (1/z‚Å∑ + c)</option>
            <option value="35">Inverse Octic (1/z‚Å∏ + c)</option>
            <option value="36">Inverse Burning Ship</option>
            <option value="37">Inverse Tricorn</option>
            <option value="38">Inverse Celtic</option>
            <option value="39">Inverse Phoenix</option>
            <option value="40">Tri-Nova</option>
            <option value="41">Nova-Mandelbrot</option>
            <option value="42">Nova 2 (inverse)</option>
            <option value="43">Nova 2 variant</option>
            <option value="44">Quartic-Nova</option>
            <option value="45">Flower Nova</option>
            <option value="46">Scatter-Nova</option>
            <option value="47">Twisted-Flower Nova</option>
            <option value="48">Lobed-Scatter Nova</option>
            <option value="49">Hybrid-FlScatter Nova</option>
            <option value="50">Fractional-Nova (p‚âà3.7)</option>
            <option value="51">Kaleido-Nova</option>
            <option value="52">Cross-Nova</option>
            <option value="53">Mirror-Nova</option>
            <option value="54">Spiro-Nova</option>
            <option value="55">Vibrant-Nova</option>
            <option value="56">Julia-Nova Hybrid</option>
            <option value="57">Inverse-Spiral Nova</option>
            <option value="58">Wavefront Nova</option>
            <option value="59">Vortex Nova</option>
            <option value="60">Sine Ring Nova</option>
            <option value="61">Inverse-Spiral Nova 2</option>
            <option value="62">Inverse-Vortex Nova</option>
            <option value="63">Inverse Sine Ring Nova</option>
            <option value="64">Inverse-Mirror Nova</option>
            <option value="65">Inverse-Vibrant Nova</option>
            <option value="66">Golden-Ratio Rational</option>
            <option value="67">SinCos-Kernel</option>
            <option value="68">Golden-Push-Pull</option>
            <option value="69">Sinc-Kernel</option>
            <option value="70">Bizarre Grid (set x/y to 1)</option>
            <option value="71">Julia (use pan x/y sliders)</option>
          </select>

          <input
            id="fractalTypeOut"
            class="numeric-input"
            type="number"
            min="0"
            max="69"
            step="1"
            value="0"
            title="Numeric fractal type index"
          />
        </label>
      </div>

      <div class="row">
        <label
          title="Choose the color palette used for mapping iterations to RGB"
        >
          üé®:
          <select
            id="colorScheme"
            title="Choose the color palette used for mapping iterations to RGB"
          >
            <option value="0">Violet-Cyan-White</option>
            <option value="6">Grayscale</option>
            <option value="1">Fire</option>
            <option value="2">Ice</option>
            <option value="3">Sunset</option>
            <option value="4">Forest</option>
            <option value="5">Neon</option>
            <option value="7">Inferno</option>
            <option value="8">Rainbow 360 ¬∞</option>
            <option value="9">Rainbow 720 ¬∞</option>
            <option value="10">Pastel Loop</option>
            <option value="11">Viridis-ish</option>
            <option value="12">Magma</option>
            <option value="13">Plasma</option>
            <option value="14">Cividis</option>
            <option value="15">Ocean</option>
            <option value="16">Midnight Blue</option>
            <option value="17">Cool-Warm Diverge</option>
            <option value="18">Rainbow 1080¬∞ (3 loops)</option>
            <option value="19">Rainbow 1440¬∞ (4 loops)</option>
            <option value="20">Pastel 5-loop</option>
            <option value="21">Thermal</option>
            <option value="22">Turbulent Wave</option>
            <option value="23">Autumn</option>
            <option value="24">Spring</option>
            <option value="25">Summer</option>
            <option value="26">Mono-loop (10√ó grayscale flicker)</option>
            <option value="27">High-contrast Diverging</option>
            <option value="28">Sine-wave Hue</option>
            <option value="29">Sawtooth Loop (3 loops)</option>
            <option value="30">Rainbow 2160¬∞ (6 loops)</option>
            <option value="31">Triangle-wave 8 loops</option>
            <option value="32">Exponential 12 loops</option>
            <option value="33">Sawtooth 10 loops + offset</option>
          </select>
        </label>
      </div>

      <!-- Global hue offset -->
      <div class="row">
        <label
          title="Shift the global hue of the palette (wraps the color wheel)"
        >
          Hue Offset:
          <input
            id="hueOffset"
            type="range"
            min="-1"
            max="1"
            step="0.001"
            value="0"
            title="Hue offset (-1 to +1)"
          />
          <input
            id="hueOffsetOut"
            class="numeric-input"
            type="number"
            min="-1"
            max="1"
            step="0.001"
            value="0.00"
            title="Exact numeric hue offset"
          />
        </label>
      </div>

      <!-- Zoom -->
      <div class="row">
        <label title="Control zoom scale (size of the complex plane window)">
          Zoom:
          <input
            id="zoom"
            type="range"
            min="0.00000001"
            max="10"
            step="0.000001"
            value="4.0"
            title="Zoom factor (lower values zoom in deeper)"
          />
          <input
            id="zoomOut"
            class="numeric-input"
            type="number"
            min="0.00000001"
            max="10"
            step="0.000001"
            value="4.00"
            title="Exact numeric zoom"
          />
        </label>
      </div>

      <!-- Pan X -->
      <div class="row">
        <label title="Shift the view left/right in the complex plane">
          Pan X:
          <input
            id="dx"
            type="range"
            min="-2"
            max="2"
            step="0.00001"
            value="0.0"
            title="Horizontal pan"
          />
          <input
            id="dxOut"
            class="numeric-input"
            type="number"
            min="-2"
            max="2"
            step="0.00001"
            value="0.00"
            title="Exact numeric pan X"
          />
        </label>
      </div>

      <!-- Pan Y -->
      <div class="row">
        <label title="Shift the view up/down in the complex plane">
          Pan Y:
          <input
            id="dy"
            type="range"
            min="-2"
            max="2"
            step="0.00001"
            value="0.0"
            title="Vertical pan"
          />
          <input
            id="dyOut"
            class="numeric-input"
            type="number"
            min="-2"
            max="2"
            step="0.00001"
            value="0.00"
            title="Exact numeric pan Y"
          />
        </label>
      </div>

      <!-- Max Iter -->
      <div class="row">
        <label
          title="Higher values reveal more detail but increase render time"
        >
          Max Iter:
          <input
            id="maxIter"
            type="range"
            min="50"
            max="5000"
            step="50"
            value="150"
            title="Max escape/convergence iterations"
          />
          <input
            id="maxIterOut"
            class="numeric-input"
            type="number"
            min="50"
            max="5000"
            step="50"
            value="150"
            title="Exact numeric iteration count"
          />
        </label>
      </div>

      <!-- Escape radius -->
      <div class="row">
        <label
          title="Escape threshold (distance where the orbit is considered divergent)"
        >
          Escape R:
          <input
            id="escapeR"
            type="range"
            min="1"
            max="20"
            step="0.1"
            value="4.0"
            title="Escape radius"
          />
          <input
            id="escapeROut"
            class="numeric-input"
            type="number"
            min="1"
            max="20"
            step="0.1"
            value="4.0"
            title="Exact numeric escape radius"
          />
        </label>
      </div>
      <hr />
      <!-- Scale Mode bitmask -->
      <div class="row">
        <label
          title="Enable optional iterative coordinate warps, toggled as a bitmask"
          >Scale Mode:</label
        >
        <div class="scale-group">
          <label title="Multiply coordinates by s">
            <input type="checkbox" name="scaleMode" value="1" /> Multiply</label
          >
          <label title="Divide coordinates by s"
            ><input type="checkbox" name="scaleMode" value="2" /> Divide</label
          >
          <label title="Apply sin(s) warp"
            ><input type="checkbox" name="scaleMode" value="4" /> Sine</label
          >
          <label title="Apply tan(s) warp"
            ><input type="checkbox" name="scaleMode" value="8" /> Tangent</label
          >
          <label title="Apply cos(s) warp"
            ><input type="checkbox" name="scaleMode" value="16" /> Cosine</label
          >
          <label title="Exponential scaling"
            ><input type="checkbox" name="scaleMode" value="32" />
            Exp-Zoom</label
          >
          <label title="Logarithmic shrink"
            ><input type="checkbox" name="scaleMode" value="64" />
            Log-Shrink</label
          >
          <label title="Stretch X and squash Y"
            ><input type="checkbox" name="scaleMode" value="128" /> Aniso
            Warp</label
          >
          <label title="Rotate coordinates by s radians"
            ><input type="checkbox" name="scaleMode" value="256" />
            Rotate</label
          >
          <label title="Twist radius/angle by s"
            ><input type="checkbox" name="scaleMode" value="512" /> Radial
            Twist</label
          >
          <label title="Hyperbolic warp"
            ><input type="checkbox" name="scaleMode" value="1024" />
            HyperWarp</label
          >
          <label title="Hyperbolic radial warp"
            ><input type="checkbox" name="scaleMode" value="2048" />
            RadialHyper</label
          >
          <label title="Add swirl proportional to s"
            ><input type="checkbox" name="scaleMode" value="4096" />
            Swirl</label
          >
          <label title="Modular wrap"
            ><input type="checkbox" name="scaleMode" value="8192" />
            Modular</label
          >
          <label title="Swap axes with scaling"
            ><input type="checkbox" name="scaleMode" value="16384" />
            AxisSwap</label
          >
          <label title="Blend sin and multiply warps"
            ><input type="checkbox" name="scaleMode" value="32768" />
            MixedWarp</label
          >
          <label title="Add jitter noise"
            ><input type="checkbox" name="scaleMode" value="65536" />
            Jitter</label
          >
          <label title="Apply signed power warp"
            ><input type="checkbox" name="scaleMode" value="131072" />
            PowerWarp</label
          >
          <label title="Smoothstep fade warp"
            ><input type="checkbox" name="scaleMode" value="262144" />
            SmoothFade</label
          >
        </div>
      </div>

      <!-- Gamma -->
      <div class="row">
        <label title="Iteration-based parameter used by warp modes">
          Gamma:
          <input
            id="gamma"
            type="range"
            min="-50"
            max="50.0"
            step="0.0001"
            value="1.0"
            title="Gamma modifier"
          />
          <input
            id="gammaOut"
            class="numeric-input"
            type="number"
            min="-50"
            max="50.0"
            step="0.0001"
            value="1.0"
            title="Exact numeric gamma"
          />
        </label>
      </div>
      <hr />
      <!-- Epsilon -->
      <div class="row">
        <label title="Convergence tolerance for Newton-like fractals">
          Epsilon:
          <input
            id="epsilon"
            type="range"
            min="0.000001"
            max="0.01"
            step="0.000001"
            value="0.000001"
            title="Convergence epsilon"
          />
          <input
            id="epsilonOut"
            class="numeric-input"
            type="number"
            min="0.000001"
            max="0.01"
            step="0.000001"
            value="0.000001"
            title="Exact numeric epsilon"
          />
        </label>
      </div>

      <div class="row">
        <label
          for="thresholdBasis"
          title="What field the threshold masking operates on"
        >
          Threshold basis
          <select id="thresholdBasis" title="Choose threshold basis">
            <option value="0">Inner</option>
            <option value="1">Outer</option>
            <option value="1">Height (normalized)</option>
          </select>
        </label>
      </div>

      <div class="row">
        <label for="lowThresh" title="Lower clamp for threshold mask">
          low
          <input
            id="lowThresh"
            type="range"
            min="0"
            max="1"
            step="0.01"
            value="0.00"
            title="Lower threshold"
          />
          <input
            id="lowVal"
            class="numeric-input"
            type="number"
            min="0"
            max="1"
            step="0.01"
            value="0.00"
            title="Exact numeric lower threshold"
          />
        </label>
      </div>

      <div class="row">
        <label for="highThresh" title="Upper clamp for threshold mask">
          high
          <input
            id="highThresh"
            type="range"
            min="0"
            max="1"
            step="0.01"
            value="1.00"
            title="Upper threshold"
          />
          <input
            id="highVal"
            class="numeric-input"
            type="number"
            min="0"
            max="1"
            step="0.01"
            value="1.00"
            title="Exact numeric upper threshold"
          />
        </label>
      </div>

      <div class="row">
        <label title="Controls final canvas alpha compositing mode">
          Alpha mode:
          <select
            id="alphaMode"
            title="How transparency is applied to rendered pixels"
          >
            <option value="0">0 - Opaque (no transparency)</option>
            <option value="1">1 - Fade out</option>
            <option value="2">2 - Reverse fade out</option>
          </select>
        </label>
      </div>

      <div class="row">
        <label
          title="Toggle convergence-based termination for Newton or hybrid maps"
        >
          <input id="convergenceTest" type="checkbox" />
          Convergence Test
        </label>
      </div>

      <div class="row">
        <label
          title="Whether the iteration should escape when diverging or converge toward a root"
        >
          Escape Mode:
          <select id="escapeMode" title="Divergence or convergence mode">
            <option value="0">Converge</option>
            <option value="1">Diverge</option>
          </select>
          <input
            id="escapeModeOut"
            class="numeric-input"
            type="number"
            min="0"
            max="1"
            step="1"
            value="0"
            title="Exact numeric escape mode"
          />
        </label>
      </div>

      <hr />
      <!-- Hidden layer controls -->
      <div class="row" style="display: none">
        <label>
          <input type="checkbox" id="layerMode" />
          Render Gamma Steps (disables Displacement/Lighting)
        </label>
      </div>

      <div class="row" style="display: none">
        <label>
          Layers:
          <input
            id="nLayers"
            type="range"
            min="1"
            max="128"
            step="1"
            value="1"
          />
          <input
            id="nLayersOut"
            class="numeric-input"
            type="number"
            min="1"
            max="128"
            step="1"
            value="1"
          />
        </label>
      </div>

      <!-- Bowl -->
      <div class="row">
        <label title="Enable radial bowl displacement for lighting/extrusion">
          <input type="checkbox" id="bowlOn" />
          Enable bowl
        </label>
      </div>

      <div class="row">
        <label title="Depth of the bowl displacement curve">
          Bowl depth
          <input
            type="range"
            id="bowlDepth"
            min="0"
            max="3.14"
            step="0.01"
            value="0.25"
            title="Bowl depth"
          />
          <input
            id="bowlDepthOut"
            class="numeric-input"
            type="number"
            min="0"
            max="3.14"
            step="0.01"
            value="0.25"
            title="Exact numeric bowl depth"
          />
        </label>
      </div>

      <!-- Quad scale -->
      <div class="row">
        <label
          title="Scale the on-screen quad used for rendering (for multi-pass / stacked zoom modes)"
        >
          Quad Scale
          <input
            id="quadScale"
            type="range"
            min="1"
            max="1000"
            step="1"
            value="1"
            title="Quad scale factor"
          />
          <input
            id="quadScaleOut"
            class="numeric-input"
            type="number"
            min="1"
            max="1000"
            step="1"
            value="1.00"
            title="Exact numeric quad scale"
          />
        </label>
      </div>

      <!-- Displacement -->
      <div class="row">
        <label
          title="Choose the type of height displacement applied to lighting / extrusion"
        >
          Displacement mode
          <select id="dispMode" title="Displacement height mapping mode">
            <option value="0">None</option>
            <option value="1">Max Peak</option>
            <option value="2">Min Peak</option>
            <option value="3">Max Peak Log</option>
            <option value="4">Min Peak Log</option>
            <option value="5">Max Peak Pow</option>
            <option value="6">Min Peak Pow</option>
          </select>
        </label>
      </div>

      <hr />
      <div class="row">
        <label title="Resolution of the displacement sampling grid">
          Grid Divs:
          <input
            id="gridDivs"
            type="range"
            min="64"
            max="4096"
            step="64"
            value="256"
            title="Displacement sampling grid resolution"
          />
          <input
            id="gridDivsOut"
            class="numeric-input"
            type="number"
            min="64"
            max="4096"
            step="64"
            value="256"
            title="Exact numeric grid divs"
          />
        </label>
      </div>

      <div class="row">
        <label title="Amplitude of displacement applied to lighting">
          Displacement amp
          <input
            type="range"
            id="dispAmp"
            min="0"
            max="2"
            step="0.01"
            value="0.15"
            title="Displacement amplitude"
          />
          <input
            id="dispAmpOut"
            class="numeric-input"
            type="number"
            min="0"
            max="2"
            step="0.01"
            value="0.15"
            title="Exact numeric displacement amplitude"
          />
        </label>
      </div>

      <div class="row">
        <label title="Curve shaping for displacement height response">
          Disp curve
          <input
            type="range"
            id="dispCurve"
            min="0.001"
            max="100"
            step="0.001"
            value="3"
            title="Displacement curve exponent"
          />
          <input
            id="dispCurveOut"
            class="numeric-input"
            type="number"
            min="0.001"
            max="100"
            step="0.001"
            value="3.0"
            title="Exact numeric curve exponent"
          />
        </label>
      </div>

      <hr />
      <div class="row">
        <label
          class="slider-row"
          title="Enable a max-slope clamp to prevent artifacts"
        >
          <span>Disp limit ON</span>
          <input id="dispLimitOn" type="checkbox" />
        </label>
      </div>

      <div class="row">
        <label
          class="slider-row"
          title="Maximum surface slope allowed (degrees)"
        >
          <span>Max Slope (deg)</span>
          <input
            id="slopeLimit"
            type="range"
            min="0.0"
            max="91"
            step="0.001"
            value="45"
            title="Maximum allowed displacement slope"
          />
          <input
            id="slopeLimitOut"
            class="numeric-input"
            type="number"
            min="0.0"
            max="91"
            step="0.001"
            value="45"
            title="Exact numeric slope limit"
          />
        </label>
      </div>

      <div class="row">
        <label
          class="slider-row"
          title="Maximum height discontinuity allowed (normalized units)"
        >
          <span>Max Wall Height (norm)</span>
          <input
            id="wallJump"
            type="range"
            min="0.0"
            max="1"
            step="0.001"
            value="0.05"
            title="Wall height clamp"
          />
          <input
            id="wallJumpOut"
            class="numeric-input"
            type="number"
            min="0.0"
            max="1"
            step="0.001"
            value="0.05"
            title="Exact numeric height clamp"
          />
        </label>
      </div>

      <hr />
      <!-- Lighting -->
      <div class="row">
        <label title="Enable Phong-style shading based on displacement height">
          Lighting ON
          <input id="lightingOn" type="checkbox" />
        </label>
      </div>

      <div class="row">
        <label title="Light position X coordinate">
          Light X
          <input
            id="lightX"
            type="range"
            min="-50"
            max="50"
            step="0.1"
            value="0"
            title="Light X coordinate"
          />
          <input
            id="lightXOut"
            class="numeric-input"
            type="number"
            min="-50"
            max="50"
            step="0.1"
            value="0.0"
            title="Numeric light X"
          />
        </label>
      </div>

      <div class="row">
        <label title="Light position Y coordinate">
          Light Y
          <input
            id="lightY"
            type="range"
            min="-50"
            max="50"
            step="0.1"
            value="0"
            title="Light Y coordinate"
          />
          <input
            id="lightYOut"
            class="numeric-input"
            type="number"
            min="-50"
            max="50"
            step="0.1"
            value="0.0"
            title="Numeric light Y"
          />
        </label>
      </div>

      <div class="row">
        <label title="Light position Z coordinate (height)">
          Light Z
          <input
            id="lightZ"
            type="range"
            min="-50"
            max="50"
            step="0.1"
            value="50"
            title="Light Z coordinate"
          />
          <input
            id="lightZOut"
            class="numeric-input"
            type="number"
            min="-50"
            max="50"
            step="0.1"
            value="50.0"
            title="Numeric light Z"
          />
        </label>
      </div>

      <div class="row">
        <label title="Specular exponent controlling shininess">
          Spec Power (shininess)
          <input
            id="specPower"
            type="range"
            min="1"
            max="128"
            step="1"
            value="32"
            title="Specular highlight power"
          />
          <input
            id="specPowerOut"
            class="numeric-input"
            type="number"
            min="1"
            max="128"
            step="1"
            value="32"
            title="Exact numeric specular power"
          />
        </label>
      </div>

      <!-- Hidden split values -->
      <div class="row" style="display: none">
        <label>
          Max Pixels/Split:
          <input
            id="splitCount"
            type="number"
            step="100000"
            min="100000"
            value="8000000"
          />
          <input
            id="splitCountOut"
            class="numeric-input"
            type="number"
            step="100000"
            min="100000"
            value="8000000"
          />
        </label>
      </div>
    </div>
  </div>
</div>
